version: "3.7"

networks:
  nextgen_network:
    external:
     name: nextgen_network

services:
  simulations-admin-service:
    networks:
      - nextgen_network

    ports:
      - 7007:3000

    command: yarn start

    # environment:
    #   - GATEWAY_URL_CLIENT=https://gateway.filadd.com
    #   - GATEWAY_URL_SERVER=http://tasks.gateway-service
    #   - GATEWAY_INTERNAL_API=http://tasks.gateway-service/internal/api
    #   - UASO_LOGIN_URL=https://filadd.com/uaso/login

    deploy:
      update_config:
        parallelism: 1
        order: start-first
        failure_action: rollback
      mode: global
      placement:
        constraints:
          - node.role == worker
          - node.platform.os == linux
          - node.labels.deploy_simulations-admin == yes
